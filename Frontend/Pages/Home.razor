@using System.Net.Http.Json;

@page "/"
@inject HttpClient Http

<PageTitle>Home</PageTitle>

<div>
    <div class="mt-5 ma-5">
        @if (products != null){
            <MudGrid>
                @foreach (var product in products)
                {
                    <MudItem xs="12" sm="6" md="4" lg="3">
                        <MudCard Height="100%">
                            <MudCardMedia Image="@product.ImageUrl" Class="mud-card-media" />
                            <MudCardContent>
                                <MudText Typo="Typo.h5">@product.Name</MudText>
                                <MudText Typo="Typo.body2">@product.Detail</MudText>
                            </MudCardContent>
                            <MudCardActions>
                                <MudButton Variant="Variant.Text" Color="Color.Primary">Share</MudButton>
                                <MudButton Variant="Variant.Text" Color="Color.Primary">Learn More</MudButton>
                            </MudCardActions>
                        </MudCard>
                    </MudItem>

                }
            </MudGrid>
        }
    </div>
</div>

@code {
    private List<Product> products;

    protected override async Task OnInitializedAsync()
    {
        await GetProducts();
    }

    private async Task GetProducts()
    {
        products = await Http.GetFromJsonAsync<List<Product>>("https://localhost:7153/api/Products/Filter");
    }

    public class Product
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Detail { get; set; }
        public string ImageUrl { get; set; }
        public decimal Price { get; set; }   
        public string CategoryName { get; set; }
    }
}