@page "/admin-products"

@if (loading)
{
    <Frontend.Shared.Loading />
}
else
{
    <AuthorizeView Roles="Admin">
        <Authorized>            
            <MudTable Items="@Products"
                      @ref="table"
                      ServerData="LoadListAsync"
                      Style="margin-left: 4rem;"
                      Dense="true"
                      Hover="true"
                      Striped="true"
                      FixedHeader="true"
                      FixedFooter="true">
                <ToolBarContent>
                    <div class="d-flex justify-content-between">
                        <MudText Typo="Typo.h6" Class="me-4"> Products</MudText>
                        <MudButton Variant="Variant.Outlined"
                                   EndIcon="@Icons.Material.Filled.Add"
                                   Color="Color.Info" OnClick="@(() => ShowModalAsync1())">
                            New
                        </MudButton>
                    </div>
                    <MudSpacer />
                    <!--
                    <FilterComponent ApplyFilter="SetFilterValue" />

                    -->
                </ToolBarContent>
                <HeaderContent>
                    <MudTh><MudText Class="me-4">Name</MudText></MudTh>
                    <MudTh># Stock</MudTh>
                    <MudTh>Actions</MudTh>
                </HeaderContent>
                <RowTemplate Context="produc" >
                    <MudTd>@produc.Name</MudTd>
                    <MudTd>@produc.Stock</MudTd>
                    <MudTd>
                        <MudTooltip Text="Edit">
                            <MudButton Variant="Variant.Filled"
                                       Color="Color.Warning"
                                       OnClick="@(() => ShowModalAsync(produc.Id, true))">
                                <MudIcon Icon="@Icons.Material.Filled.Edit" />
                            </MudButton>
                        </MudTooltip>
                        <MudTooltip Text="Delete">
                            <MudButton Variant="Variant.Filled"
                                       Color="Color.Error"
                                       OnClick="@(() => DeleteAsync(@produc))">
                                <MudIcon Icon="@Icons.Material.Filled.Delete" />
                            </MudButton>
                        </MudTooltip>
                    </MudTd>
                </RowTemplate>
                <NoRecordsContent>
                    <MudText>NoRecords</MudText>
                </NoRecordsContent>
                <PagerContent>
                    <MudTablePager RowsPerPageString="Records Number"
                                   PageSizeOptions="pageSizeOptions"
                                   AllItemsText="All"
                                   InfoFormat="@infoFormat" />
                </PagerContent>
            </MudTable>
        </Authorized>
    </AuthorizeView>
}